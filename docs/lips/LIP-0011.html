<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="generator" content="Rspress v1.45.0">
    <title data-rh="true">LEA Chain</title><meta data-rh="true" name="description" content="Technical Documentation for LEA Chain"/>
  <script>{;const saved = localStorage.getItem('rspress-theme-appearance');const preferDark = window.matchMedia('(prefers-color-scheme: dark)').matches;const isDark = !saved || saved === 'auto' ? preferDark : saved === 'dark';document.documentElement.classList.toggle('dark', isDark);document.documentElement.style.colorScheme = isDark ? 'dark' : 'light';}</script><link rel="icon" href="/logo.png"><script defer src="/static/js/styles.560c21a5.js"></script><script defer src="/static/js/lib-react.1eeaa575.js"></script><script defer src="/static/js/lib-router.2a966dcf.js"></script><script defer src="/static/js/162.49e0a391.js"></script><script defer src="/static/js/index.9579a0c3.js"></script><link href="/static/css/styles.e45a8283.css" rel="stylesheet"></head>

  <body >
    <div id="root"><div class="navContainer_d18b1 rspress-nav px-6  sticky_ddfa7"><div class="container_e4235 flex justify-between items-center h-full"><div class="navBarTitle_c5f07"><a href="/index.html" class="link_a7cea flex items-center w-full h-full text-base font-semibold transition-opacity duration-300 hover:opacity-60"><div class="mr-1 min-w-8"><img src="/logo.png" alt="logo" id="logo" class="rspress-logo dark:hidden"/><img src="/logo.png" alt="logo" id="logo" class="rspress-logo hidden dark:block"/></div></a></div><div class="flex flex-1 justify-end items-center"><div class="rightNav_a2fea"><div class="flex sm:flex-1 items-center sm:pl-4 sm:pr-2"><div class="rspress-nav-search-button navSearchButton_df1fb"><button><svg width="18" height="18" viewBox="0 0 32 32"><path fill="var(--rp-c-gray)" d="m29 27.586-7.552-7.552a11.018 11.018 0 1 0-1.414 1.414L27.586 29ZM4 13a9 9 0 1 1 9 9 9.01 9.01 0 0 1-9-9"></path></svg><p class="searchWord_af2c1">Search Docs</p><div style="opacity:0"><span></span><span>K</span></div></button></div><div class="mobileNavSearchButton_d85a9"><svg width="24" height="24" viewBox="0 0 32 32"><path fill="var(--rp-c-gray)" d="m29 27.586-7.552-7.552a11.018 11.018 0 1 0-1.414 1.414L27.586 29ZM4 13a9 9 0 1 1 9 9 9.01 9.01 0 0 1-9-9"></path></svg></div></div><div class="rspress-nav-menu menu h-14"><a href="/index.html" class="link_a7cea "><div class="rspress-nav-menu-item singleItem_c1154 activeItem_a28b5 text-sm font-medium mx-0.5 px-3 py-2 flex items-center">Home</div></a><a href="/guide.html" class="link_a7cea "><div class="rspress-nav-menu-item singleItem_c1154  text-sm font-medium mx-0.5 px-3 py-2 flex items-center">Guide</div></a><a href="/lips/index.html" class="link_a7cea "><div class="rspress-nav-menu-item singleItem_c1154 activeItem_a28b5 text-sm font-medium mx-0.5 px-3 py-2 flex items-center">LIPs</div></a><a href="/npm-module/index.html" class="link_a7cea "><div class="rspress-nav-menu-item singleItem_c1154  text-sm font-medium mx-0.5 px-3 py-2 flex items-center">NPM Module</div></a><a href="/tools/index.html" class="link_a7cea "><div class="rspress-nav-menu-item singleItem_c1154  text-sm font-medium mx-0.5 px-3 py-2 flex items-center">Tools</div></a><a href="/development/index.html" class="link_a7cea "><div class="rspress-nav-menu-item singleItem_c1154  text-sm font-medium mx-0.5 px-3 py-2 flex items-center">Development</div></a></div><div class="flex-center flex-row"><div class="mx-2"><div class="md:mr-2 rspress-nav-appearance"><div class="p-1 border border-solid border-gray-300 text-gray-400  cursor-pointer rounded-md hover:border-gray-600 hover:text-gray-600 dark:hover:border-gray-200 dark:hover:text-gray-200 transition-all duration-300 w-7 h-7"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" viewBox="0 0 24 24" class="dark:hidden" width="18" height="18" fill="currentColor"><path d="M12 18c-3.3 0-6-2.7-6-6s2.7-6 6-6 6 2.7 6 6-2.7 6-6 6m0-10c-2.2 0-4 1.8-4 4s1.8 4 4 4 4-1.8 4-4-1.8-4-4-4M12 4c-.6 0-1-.4-1-1V1c0-.6.4-1 1-1s1 .4 1 1v2c0 .6-.4 1-1 1M12 24c-.6 0-1-.4-1-1v-2c0-.6.4-1 1-1s1 .4 1 1v2c0 .6-.4 1-1 1M5.6 6.6c-.3 0-.5-.1-.7-.3L3.5 4.9c-.4-.4-.4-1 0-1.4s1-.4 1.4 0l1.4 1.4c.4.4.4 1 0 1.4-.1.2-.4.3-.7.3M19.8 20.8c-.3 0-.5-.1-.7-.3l-1.4-1.4c-.4-.4-.4-1 0-1.4s1-.4 1.4 0l1.4 1.4c.4.4.4 1 0 1.4-.2.2-.5.3-.7.3M3 13H1c-.6 0-1-.4-1-1s.4-1 1-1h2c.6 0 1 .4 1 1s-.4 1-1 1M23 13h-2c-.6 0-1-.4-1-1s.4-1 1-1h2c.6 0 1 .4 1 1s-.4 1-1 1M4.2 20.8c-.3 0-.5-.1-.7-.3-.4-.4-.4-1 0-1.4l1.4-1.4c.4-.4 1-.4 1.4 0s.4 1 0 1.4l-1.4 1.4c-.2.2-.4.3-.7.3M18.4 6.6c-.3 0-.5-.1-.7-.3-.4-.4-.4-1 0-1.4l1.4-1.4c.4-.4 1-.4 1.4 0s.4 1 0 1.4l-1.4 1.4c-.2.2-.5.3-.7.3"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" viewBox="0 0 24 24" class="hidden dark:block" width="18" height="18" fill="currentColor"><path d="M12.1 22h-.9c-5.5-.5-9.5-5.4-9-10.9.4-4.8 4.2-8.6 9-9 .4 0 .8.2 1 .5s.2.8-.1 1.1c-2 2.7-1.4 6.4 1.3 8.4 2.1 1.6 5 1.6 7.1 0 .3-.2.7-.3 1.1-.1.3.2.5.6.5 1-.2 2.7-1.5 5.1-3.6 6.8-1.9 1.4-4.1 2.2-6.4 2.2M9.3 4.4c-2.9 1-5 3.6-5.2 6.8-.4 4.4 2.8 8.3 7.2 8.7 2.1.2 4.2-.4 5.8-1.8 1.1-.9 1.9-2.1 2.4-3.4-2.5.9-5.3.5-7.5-1.1-2.8-2.2-3.9-5.9-2.7-9.2"></path></svg></div></div></div><div class="social-links menu-item_e90a6 flex-center relative"><div class="flex-center h-full gap-x-4 transition-colors duration-300 md:mr-2"><a href="https://github.com/web-infra-dev/rspress" target="_blank" rel="noopener noreferrer" class="social-links"><div class="social-links-icon_a4ad0"><div><svg xmlns="http://www.w3.org/2000/svg" width="100%" viewBox="0 0 24 24"><path fill="currentColor" d="M12 .297c-6.63 0-12 5.373-12 12c0 5.303 3.438 9.8 8.205 11.385c.6.113.82-.258.82-.577c0-.285-.01-1.04-.015-2.04c-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729c1.205.084 1.838 1.236 1.838 1.236c1.07 1.835 2.809 1.305 3.495.998c.108-.776.417-1.305.76-1.605c-2.665-.3-5.466-1.332-5.466-5.93c0-1.31.465-2.38 1.235-3.22c-.135-.303-.54-1.523.105-3.176c0 0 1.005-.322 3.3 1.23c.96-.267 1.98-.399 3-.405c1.02.006 2.04.138 3 .405c2.28-1.552 3.285-1.23 3.285-1.23c.645 1.653.24 2.873.12 3.176c.765.84 1.23 1.91 1.23 3.22c0 4.61-2.805 5.625-5.475 5.92c.42.36.81 1.096.81 2.22c0 1.606-.015 2.896-.015 3.286c0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg></div></div></a></div></div></div></div><div class="mobileNavMenu_e7045"><div class="navScreen_ec30c  rspress-nav-screen" id="navScreen"><div class="container_c935d"><div class="navMenu_b887b"><div class="navMenuItem_e7978 w-full"><a href="/index.html" class="link_a7cea "><div class="rspress-nav-menu-item singleItem_c1154 activeItem_a28b5 text-sm font-medium mx-1.5 px-3 py-2 flex items-center">Home</div></a></div><div class="navMenuItem_e7978 w-full"><a href="/guide.html" class="link_a7cea "><div class="rspress-nav-menu-item singleItem_c1154  text-sm font-medium mx-1.5 px-3 py-2 flex items-center">Guide</div></a></div><div class="navMenuItem_e7978 w-full"><a href="/lips/index.html" class="link_a7cea "><div class="rspress-nav-menu-item singleItem_c1154 activeItem_a28b5 text-sm font-medium mx-1.5 px-3 py-2 flex items-center">LIPs</div></a></div><div class="navMenuItem_e7978 w-full"><a href="/npm-module/index.html" class="link_a7cea "><div class="rspress-nav-menu-item singleItem_c1154  text-sm font-medium mx-1.5 px-3 py-2 flex items-center">NPM Module</div></a></div><div class="navMenuItem_e7978 w-full"><a href="/tools/index.html" class="link_a7cea "><div class="rspress-nav-menu-item singleItem_c1154  text-sm font-medium mx-1.5 px-3 py-2 flex items-center">Tools</div></a></div><div class="navMenuItem_e7978 w-full"><a href="/development/index.html" class="link_a7cea "><div class="rspress-nav-menu-item singleItem_c1154  text-sm font-medium mx-1.5 px-3 py-2 flex items-center">Development</div></a></div></div><div class="flex-center flex-col gap-2"><div class="mt-2 navAppearance_bf893 flex justify-center"></div><div class="social-links menu-item_e90a6 flex-center relative"><div class="flex-center h-full gap-x-4 transition-colors duration-300 md:mr-2"><a href="https://github.com/web-infra-dev/rspress" target="_blank" rel="noopener noreferrer" class="social-links"><div class="social-links-icon_a4ad0"><div><svg xmlns="http://www.w3.org/2000/svg" width="100%" viewBox="0 0 24 24"><path fill="currentColor" d="M12 .297c-6.63 0-12 5.373-12 12c0 5.303 3.438 9.8 8.205 11.385c.6.113.82-.258.82-.577c0-.285-.01-1.04-.015-2.04c-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729c1.205.084 1.838 1.236 1.838 1.236c1.07 1.835 2.809 1.305 3.495.998c.108-.776.417-1.305.76-1.605c-2.665-.3-5.466-1.332-5.466-5.93c0-1.31.465-2.38 1.235-3.22c-.135-.303-.54-1.523.105-3.176c0 0 1.005-.322 3.3 1.23c.96-.267 1.98-.399 3-.405c1.02.006 2.04.138 3 .405c2.28-1.552 3.285-1.23 3.285-1.23c.645 1.653.24 2.873.12 3.176c.765.84 1.23 1.91 1.23 3.22c0 4.61-2.805 5.625-5.475 5.92c.42.36.81 1.096.81 2.22c0 1.606-.015 2.896-.015 3.286c0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg></div></div></a></div></div></div></div></div><button aria-label="mobile hamburger" class=" rspress-mobile-hamburger navHamburger_ac64c text-gray-500"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32" fill="currentColor"><circle cx="8" cy="16" r="2" fill="currentColor"></circle><circle cx="16" cy="16" r="2" fill="currentColor"></circle><circle cx="24" cy="16" r="2" fill="currentColor"></circle></svg></button></div></div></div></div><section><div class="docLayout_af141 pt-0"><aside class="sidebar_dd719 rspress-sidebar "><div class="navTitleMask_fb17c"><div class="navBarTitle_c5f07"><a href="/index.html" class="link_a7cea flex items-center w-full h-full text-base font-semibold transition-opacity duration-300 hover:opacity-60"><div class="mr-1 min-w-8"><img src="/logo.png" alt="logo" id="logo" class="rspress-logo dark:hidden"/><img src="/logo.png" alt="logo" id="logo" class="rspress-logo hidden dark:block"/></div></a></div></div><div class="rspress-scrollbar sidebarContent_da296"><nav class="pb-2"><a href="/lips/index.html" class="link_a7cea menuLink_bb039"><div class="menuItem_ac22e mt-0.5 py-2 px-3 font-medium flex" style="font-size:14px;margin-left:0;border-radius:0 var(--rp-radius) var(--rp-radius) 0;padding-left:24px;font-weight:bold"><span>LIPs Index</span></div></a><section class="rspress-sidebar-section mt-0.5 block" style="margin-left:0"><div class="rspress-sidebar-collapse flex justify-between items-center menuItem_ac22e" style="border-radius:0 var(--rp-radius) var(--rp-radius) 0;cursor:pointer"><h2 class="py-2 px-3 text-sm font-medium flex" style="font-size:14px;padding-left:24px;font-weight:bold"><span class="flex-center" style="font-size:14px">Meta/Process</span></h2><div class="collapseContainer_d6e4e p-2 rounded-xl"><div style="cursor:pointer;transition:transform 0.2s ease-out;transform:rotate(90deg)"><svg width="1em" height="1em" viewBox="0 0 32 32"><path fill="currentColor" d="M22 16 12 26l-1.4-1.4 8.6-8.6-8.6-8.6L12 6z"></path></svg></div></div></div><div class="transition-all duration-300 ease-in-out" style="overflow:hidden"><div class="rspress-sidebar-group transition-opacity duration-500 ease-in-out" style="opacity:1;margin-left:12px"><div class="rspress-sidebar-item"><a href="/lips/LIP-0003.html" class="link_a7cea menuLink_bb039"><div class="menuItem_ac22e mt-0.5 py-2 px-3 font-medium flex" style="font-size:13px;margin-left:18px;border-radius:0 var(--rp-radius) var(--rp-radius) 0"><span>LIP-0003: LIP Structure and Process</span></div></a></div></div></div></section><section class="rspress-sidebar-section mt-0.5 block" style="margin-left:0"><div class="rspress-sidebar-collapse flex justify-between items-center menuItem_ac22e" style="border-radius:0 var(--rp-radius) var(--rp-radius) 0;cursor:pointer"><h2 class="py-2 px-3 text-sm font-medium flex" style="font-size:14px;padding-left:24px;font-weight:bold"><span class="flex-center" style="font-size:14px">Core Encoding</span></h2><div class="collapseContainer_d6e4e p-2 rounded-xl"><div style="cursor:pointer;transition:transform 0.2s ease-out;transform:rotate(90deg)"><svg width="1em" height="1em" viewBox="0 0 32 32"><path fill="currentColor" d="M22 16 12 26l-1.4-1.4 8.6-8.6-8.6-8.6L12 6z"></path></svg></div></div></div><div class="transition-all duration-300 ease-in-out" style="overflow:hidden"><div class="rspress-sidebar-group transition-opacity duration-500 ease-in-out" style="opacity:1;margin-left:12px"><div class="rspress-sidebar-item"><a href="/lips/LIP-0006.html" class="link_a7cea menuLink_bb039"><div class="menuItem_ac22e mt-0.5 py-2 px-3 font-medium flex" style="font-size:13px;margin-left:18px;border-radius:0 var(--rp-radius) var(--rp-radius) 0"><span>LIP-0006: Replace Core Transaction Encoding (CTE) with Simple Compact Transaction Protocol (SCTP)</span></div></a></div></div></div></section><section class="rspress-sidebar-section mt-0.5 block" style="margin-left:0"><div class="rspress-sidebar-collapse flex justify-between items-center menuItem_ac22e" style="border-radius:0 var(--rp-radius) var(--rp-radius) 0;cursor:pointer"><h2 class="py-2 px-3 text-sm font-medium flex" style="font-size:14px;padding-left:24px;font-weight:bold"><span class="flex-center" style="font-size:14px">Application</span></h2><div class="collapseContainer_d6e4e p-2 rounded-xl"><div style="cursor:pointer;transition:transform 0.2s ease-out;transform:rotate(90deg)"><svg width="1em" height="1em" viewBox="0 0 32 32"><path fill="currentColor" d="M22 16 12 26l-1.4-1.4 8.6-8.6-8.6-8.6L12 6z"></path></svg></div></div></div><div class="transition-all duration-300 ease-in-out" style="overflow:hidden"><div class="rspress-sidebar-group transition-opacity duration-500 ease-in-out" style="opacity:1;margin-left:12px"><div class="rspress-sidebar-item"><a href="/lips/LIP-0007.html" class="link_a7cea menuLink_bb039"><div class="menuItem_ac22e mt-0.5 py-2 px-3 font-medium flex" style="font-size:13px;margin-left:18px;border-radius:0 var(--rp-radius) var(--rp-radius) 0"><span>LIP-0007: Genesis LEA Transaction Decoder Format</span></div></a></div><div class="rspress-sidebar-item"><a href="/lips/LIP-0008.html" class="link_a7cea menuLink_bb039"><div class="menuItem_ac22e mt-0.5 py-2 px-3 font-medium flex" style="font-size:13px;margin-left:18px;border-radius:0 var(--rp-radius) var(--rp-radius) 0"><span>LIP-0008: LEA WebAssembly VM&#x27;s Supported Features</span></div></a></div><div class="rspress-sidebar-item"><a href="/lips/LIP-0010.html" class="link_a7cea menuLink_bb039"><div class="menuItem_ac22e mt-0.5 py-2 px-3 font-medium flex" style="font-size:13px;margin-left:18px;border-radius:0 var(--rp-radius) var(--rp-radius) 0"><span>LIP-0010: LEA Transaction Manifest (LTM)</span></div></a></div><div class="rspress-sidebar-item"><a href="/lips/LIP-0011.html" class="link_a7cea menuLink_bb039"><div class="menuItemActive_de63c mt-0.5 py-2 px-3 font-medium flex" style="font-size:13px;margin-left:18px;border-radius:0 var(--rp-radius) var(--rp-radius) 0"><span>LIP-0011: LEA Public Key Module Interface (LEA-PKMI)</span></div></a></div><div class="rspress-sidebar-item"><a href="/lips/LIP-0012.html" class="link_a7cea menuLink_bb039"><div class="menuItem_ac22e mt-0.5 py-2 px-3 font-medium flex" style="font-size:13px;margin-left:18px;border-radius:0 var(--rp-radius) var(--rp-radius) 0"><span>LIP-0012: LEA Keyset File Format</span></div></a></div></div></div></section><section class="rspress-sidebar-section mt-0.5 block" style="margin-left:0"><div class="rspress-sidebar-collapse flex justify-between items-center menuItem_ac22e" style="border-radius:0 var(--rp-radius) var(--rp-radius) 0;cursor:pointer"><h2 class="py-2 px-3 text-sm font-medium flex" style="font-size:14px;padding-left:24px;font-weight:bold"><span class="flex-center" style="font-size:14px">Consensus</span></h2><div class="collapseContainer_d6e4e p-2 rounded-xl"><div style="cursor:pointer;transition:transform 0.2s ease-out;transform:rotate(90deg)"><svg width="1em" height="1em" viewBox="0 0 32 32"><path fill="currentColor" d="M22 16 12 26l-1.4-1.4 8.6-8.6-8.6-8.6L12 6z"></path></svg></div></div></div><div class="transition-all duration-300 ease-in-out" style="overflow:hidden"><div class="rspress-sidebar-group transition-opacity duration-500 ease-in-out" style="opacity:1;margin-left:12px"><div class="rspress-sidebar-item"><a href="/lips/LIP-0009.html" class="link_a7cea menuLink_bb039"><div class="menuItem_ac22e mt-0.5 py-2 px-3 font-medium flex" style="font-size:13px;margin-left:18px;border-radius:0 var(--rp-radius) var(--rp-radius) 0"><span>LIP-0009: Programmable Transaction Format</span></div></a></div></div></div></section></nav></div></aside><div class="flex-1 relative min-w-0"><div class="rspress-sidebar-menu-container "><div class="rspress-sidebar-menu"><button type="button" class="flex-center mr-auto"><div class="text-md mr-2"><svg width="1em" height="1em" viewBox="0 0 32 32"><path fill="currentColor" d="M4 6h24v2H4zm0 18h24v2H4zm0-12h24v2H4zm0 6h24v2H4z"></path></svg></div><span class="text-sm">Menu</span></button><button type="button" class="flex-center ml-auto"><span class="text-sm">ON THIS PAGE</span><div class="text-md mr-2" style="transform:rotate(0deg);transition:transform 0.2s ease-out;margin-top:2px"><svg width="1em" height="1em" viewBox="0 0 32 32"><path fill="currentColor" d="M22 16 12 26l-1.4-1.4 8.6-8.6-8.6-8.6L12 6z"></path></svg></div></button><div class="rspress-local-toc-container "><ul><li><a href="#abstract" class="link_a7cea rspress-toc-link sm:text-normal text-sm" style="margin-left:0"><span class="rspress-toc-link-text block">Abstract</span></a></li><li><a href="#motivation" class="link_a7cea rspress-toc-link sm:text-normal text-sm" style="margin-left:0"><span class="rspress-toc-link-text block">Motivation</span></a></li><li><a href="#specification" class="link_a7cea rspress-toc-link sm:text-normal text-sm" style="margin-left:0"><span class="rspress-toc-link-text block">Specification</span></a></li><li><a href="#1-imports" class="link_a7cea rspress-toc-link sm:text-normal text-sm" style="margin-left:12px"><span class="rspress-toc-link-text block">1. Imports</span></a></li><li><a href="#2-exports" class="link_a7cea rspress-toc-link sm:text-normal text-sm" style="margin-left:12px"><span class="rspress-toc-link-text block">2. Exports</span></a></li><li><a href="#21-memory" class="link_a7cea rspress-toc-link sm:text-normal text-sm" style="margin-left:24px"><span class="rspress-toc-link-text block">2.1. Memory</span></a></li><li><a href="#22-allocator-functions" class="link_a7cea rspress-toc-link sm:text-normal text-sm" style="margin-left:24px"><span class="rspress-toc-link-text block">2.2. Allocator Functions</span></a></li><li><a href="#23-constant-functions" class="link_a7cea rspress-toc-link sm:text-normal text-sm" style="margin-left:24px"><span class="rspress-toc-link-text block">2.3. Constant Functions</span></a></li><li><a href="#24-cryptographic-functions" class="link_a7cea rspress-toc-link sm:text-normal text-sm" style="margin-left:24px"><span class="rspress-toc-link-text block">2.4. Cryptographic Functions</span></a></li><li><a href="#rationale" class="link_a7cea rspress-toc-link sm:text-normal text-sm" style="margin-left:0"><span class="rspress-toc-link-text block">Rationale</span></a></li><li><a href="#backwards-compatibility" class="link_a7cea rspress-toc-link sm:text-normal text-sm" style="margin-left:0"><span class="rspress-toc-link-text block">Backwards Compatibility</span></a></li><li><a href="#security-considerations" class="link_a7cea rspress-toc-link sm:text-normal text-sm" style="margin-left:0"><span class="rspress-toc-link-text block">Security Considerations</span></a></li><li><a href="#copyright" class="link_a7cea rspress-toc-link sm:text-normal text-sm" style="margin-left:0"><span class="rspress-toc-link-text block">Copyright</span></a></li></ul></div></div></div><div class="content_ff766 rspress-doc-container flex"><div class="flex-1 overflow-x-auto"><div class="rspress-doc"><!--$--><ul class="list-disc pl-5 my-4 leading-7">
<li class="[&amp;:not(:first-child)]:mt-2"><strong class="font-semibold">LIP: 11</strong></li>
<li class="[&amp;:not(:first-child)]:mt-2"><strong class="font-semibold">Layer: Application</strong></li>
<li class="[&amp;:not(:first-child)]:mt-2"><strong class="font-semibold">Title: LEA Public Key Module Interface (LEA-PKMI)</strong></li>
<li class="[&amp;:not(:first-child)]:mt-2"><strong class="font-semibold">Author: Allwin Ketnawang</strong></li>
<li class="[&amp;:not(:first-child)]:mt-2"><strong class="font-semibold">Created: 2025-07-16</strong></li>
<li class="[&amp;:not(:first-child)]:mt-2"><strong class="font-semibold">Status: Proposed</strong></li>
</ul>
<h2 id="abstract" class="mt-12 mb-6 pt-8 text-2xl tracking-tight border-t-[1px] border-divider-light title_fb7eb">Abstract<a class="link_a7cea header-anchor link_a9ef4 inline-link_f855c" aria-hidden="true" href="#abstract">#</a></h2>
<p class="my-4 leading-7">This LIP defines a standard interface for WebAssembly (WASM) modules that provide public-key cryptography functions. The LEA Public Key Module Interface (LEA-PKMI) specifies a set of required imports and exports that enable seamless integration of cryptographic modules for operations like key generation, signing, and verification within the LEA ecosystem. This standardization promotes interoperability, simplifies development, and allows for modular replacement of cryptographic implementations.</p>
<h2 id="motivation" class="mt-12 mb-6 pt-8 text-2xl tracking-tight border-t-[1px] border-divider-light title_fb7eb">Motivation<a class="link_a7cea header-anchor link_a9ef4 inline-link_f855c" aria-hidden="true" href="#motivation">#</a></h2>
<p class="my-4 leading-7">As the LEA ecosystem grows, there is a need for a standardized way to perform public-key cryptography across different applications and environments. Without a defined interface, developers must write custom &quot;glue code&quot; for each specific cryptographic library, leading to duplicated effort, increased complexity, and a higher risk of implementation errors.</p>
<p class="my-4 leading-7">The LEA-PKMI provides a clear, minimal, and efficient contract between a host environment and a WASM-based cryptographic module. This allows developers to easily swap different modules (e.g., switching from an Ed25519 module to a different signature scheme) without changing the host application&#x27;s code, fostering a more flexible and secure development environment.</p>
<h2 id="specification" class="mt-12 mb-6 pt-8 text-2xl tracking-tight border-t-[1px] border-divider-light title_fb7eb">Specification<a class="link_a7cea header-anchor link_a9ef4 inline-link_f855c" aria-hidden="true" href="#specification">#</a></h2>
<p class="my-4 leading-7">Any WASM module compliant with LEA-PKMI MUST implement the following interface.</p>
<h3 id="1-imports" class="mt-10 mb-2 leading-7 text-xl title_fb7eb">1. Imports<a class="link_a7cea header-anchor link_a9ef4 inline-link_f855c" aria-hidden="true" href="#1-imports">#</a></h3>
<p class="my-4 leading-7">The module MUST import the following functions from the host environment under the <code>env</code> namespace.</p>
<ul class="list-disc pl-5 my-4 leading-7">
<li class="[&amp;:not(:first-child)]:mt-2">
<p class="my-4 leading-7"><code>__lea_abort(line: i32)</code></p>
<ul class="list-disc pl-5 my-4 leading-7">
<li class="[&amp;:not(:first-child)]:mt-2"><strong class="font-semibold">Description</strong>: Called by the module to signal a fatal, unrecoverable error.</li>
<li class="[&amp;:not(:first-child)]:mt-2"><strong class="font-semibold">Parameters</strong>:<!-- -->
<ul class="list-disc pl-5 my-4 leading-7">
<li class="[&amp;:not(:first-child)]:mt-2"><code>line</code>: A 32-bit integer representing the source code line number where the error occurred.</li>
</ul>
</li>
<li class="[&amp;:not(:first-child)]:mt-2"><strong class="font-semibold">Host Action</strong>: The host must terminate the execution environment.</li>
</ul>
</li>
<li class="[&amp;:not(:first-child)]:mt-2">
<p class="my-4 leading-7"><code>__lea_randombytes(ptr: i32, len: i32)</code></p>
<ul class="list-disc pl-5 my-4 leading-7">
<li class="[&amp;:not(:first-child)]:mt-2"><strong class="font-semibold">Description</strong>: Called by the module to request cryptographically secure random data.</li>
<li class="[&amp;:not(:first-child)]:mt-2"><strong class="font-semibold">Parameters</strong>:<!-- -->
<ul class="list-disc pl-5 my-4 leading-7">
<li class="[&amp;:not(:first-child)]:mt-2"><code>ptr</code>: A 32-bit integer representing the memory address where the host should write the random data.</li>
<li class="[&amp;:not(:first-child)]:mt-2"><code>len</code>: A 32-bit integer specifying the number of bytes to write.</li>
</ul>
</li>
<li class="[&amp;:not(:first-child)]:mt-2"><strong class="font-semibold">Host Action</strong>: The host must fill the module&#x27;s linear memory at <code>ptr</code> with <code>len</code> bytes of secure random data.</li>
</ul>
</li>
</ul>
<h3 id="2-exports" class="mt-10 mb-2 leading-7 text-xl title_fb7eb">2. Exports<a class="link_a7cea header-anchor link_a9ef4 inline-link_f855c" aria-hidden="true" href="#2-exports">#</a></h3>
<p class="my-4 leading-7">The module MUST export the following memory and functions.</p>
<h4 id="21-memory" class="mt-8 leading-6 text-lg title_fb7eb">2.1. Memory<a class="link_a7cea header-anchor link_a9ef4 inline-link_f855c" aria-hidden="true" href="#21-memory">#</a></h4>
<ul class="list-disc pl-5 my-4 leading-7">
<li class="[&amp;:not(:first-child)]:mt-2"><code>memory: WebAssembly.Memory</code>
<ul class="list-disc pl-5 my-4 leading-7">
<li class="[&amp;:not(:first-child)]:mt-2"><strong class="font-semibold">Description</strong>: The module&#x27;s linear memory. The host uses this to write input data (e.g., messages) and read output data (e.g., keys, signatures).</li>
</ul>
</li>
</ul>
<h4 id="22-allocator-functions" class="mt-8 leading-6 text-lg title_fb7eb">2.2. Allocator Functions<a class="link_a7cea header-anchor link_a9ef4 inline-link_f855c" aria-hidden="true" href="#22-allocator-functions">#</a></h4>
<ul class="list-disc pl-5 my-4 leading-7">
<li class="[&amp;:not(:first-child)]:mt-2">
<p class="my-4 leading-7"><code>__lea_malloc(size: i32): i32</code></p>
<ul class="list-disc pl-5 my-4 leading-7">
<li class="[&amp;:not(:first-child)]:mt-2"><strong class="font-semibold">Description</strong>: Allocates a memory block of <code>size</code> bytes.</li>
<li class="[&amp;:not(:first-child)]:mt-2"><strong class="font-semibold">Returns</strong>: A pointer to the start of the allocated block.</li>
</ul>
</li>
<li class="[&amp;:not(:first-child)]:mt-2">
<p class="my-4 leading-7"><code>__lea_allocator_reset()</code></p>
<ul class="list-disc pl-5 my-4 leading-7">
<li class="[&amp;:not(:first-child)]:mt-2"><strong class="font-semibold">Description</strong>: Resets the module&#x27;s internal allocator, invalidating all pointers.</li>
</ul>
</li>
</ul>
<h4 id="23-constant-functions" class="mt-8 leading-6 text-lg title_fb7eb">2.3. Constant Functions<a class="link_a7cea header-anchor link_a9ef4 inline-link_f855c" aria-hidden="true" href="#23-constant-functions">#</a></h4>
<ul class="list-disc pl-5 my-4 leading-7">
<li class="[&amp;:not(:first-child)]:mt-2">
<p class="my-4 leading-7"><code>pk_bytes(): i32</code></p>
<ul class="list-disc pl-5 my-4 leading-7">
<li class="[&amp;:not(:first-child)]:mt-2"><strong class="font-semibold">Returns</strong>: The required size in bytes for a public key.</li>
</ul>
</li>
<li class="[&amp;:not(:first-child)]:mt-2">
<p class="my-4 leading-7"><code>sk_bytes(): i32</code></p>
<ul class="list-disc pl-5 my-4 leading-7">
<li class="[&amp;:not(:first-child)]:mt-2"><strong class="font-semibold">Returns</strong>: The required size in bytes for a secret key.</li>
</ul>
</li>
<li class="[&amp;:not(:first-child)]:mt-2">
<p class="my-4 leading-7"><code>signature_bytes(): i32</code></p>
<ul class="list-disc pl-5 my-4 leading-7">
<li class="[&amp;:not(:first-child)]:mt-2"><strong class="font-semibold">Returns</strong>: The required size in bytes for a signature.</li>
</ul>
</li>
</ul>
<h4 id="24-cryptographic-functions" class="mt-8 leading-6 text-lg title_fb7eb">2.4. Cryptographic Functions<a class="link_a7cea header-anchor link_a9ef4 inline-link_f855c" aria-hidden="true" href="#24-cryptographic-functions">#</a></h4>
<p class="my-4 leading-7">These functions MUST return <code>0</code> on success and a non-zero integer on failure.</p>
<ul class="list-disc pl-5 my-4 leading-7">
<li class="[&amp;:not(:first-child)]:mt-2">
<p class="my-4 leading-7"><code>keygen(pk_ptr: i32, sk_ptr: i32): i32</code></p>
<ul class="list-disc pl-5 my-4 leading-7">
<li class="[&amp;:not(:first-child)]:mt-2"><strong class="font-semibold">Description</strong>: Generates a new key pair.</li>
<li class="[&amp;:not(:first-child)]:mt-2"><strong class="font-semibold">Parameters</strong>:<!-- -->
<ul class="list-disc pl-5 my-4 leading-7">
<li class="[&amp;:not(:first-child)]:mt-2"><code>pk_ptr</code>: Pointer to an allocated block for the public key.</li>
<li class="[&amp;:not(:first-child)]:mt-2"><code>sk_ptr</code>: Pointer to an allocated block for the secret key.</li>
</ul>
</li>
</ul>
</li>
<li class="[&amp;:not(:first-child)]:mt-2">
<p class="my-4 leading-7"><code>sign(sig_ptr: i32, msg_ptr: i32, msg_len: i32, sk_ptr: i32): i32</code></p>
<ul class="list-disc pl-5 my-4 leading-7">
<li class="[&amp;:not(:first-child)]:mt-2"><strong class="font-semibold">Description</strong>: Signs a message with a secret key.</li>
<li class="[&amp;:not(:first-child)]:mt-2"><strong class="font-semibold">Parameters</strong>:<!-- -->
<ul class="list-disc pl-5 my-4 leading-7">
<li class="[&amp;:not(:first-child)]:mt-2"><code>sig_ptr</code>: Pointer to an allocated block for the output signature.</li>
<li class="[&amp;:not(:first-child)]:mt-2"><code>msg_ptr</code>: Pointer to the message to be signed.</li>
<li class="[&amp;:not(:first-child)]:mt-2"><code>msg_len</code>: The length of the message.</li>
<li class="[&amp;:not(:first-child)]:mt-2"><code>sk_ptr</code>: Pointer to the secret key.</li>
</ul>
</li>
</ul>
</li>
<li class="[&amp;:not(:first-child)]:mt-2">
<p class="my-4 leading-7"><code>verify(sig_ptr: i32, msg_ptr: i32, msg_len: i32, pk_ptr: i32): i32</code></p>
<ul class="list-disc pl-5 my-4 leading-7">
<li class="[&amp;:not(:first-child)]:mt-2"><strong class="font-semibold">Description</strong>: Verifies a signature against a message and public key.</li>
<li class="[&amp;:not(:first-child)]:mt-2"><strong class="font-semibold">Parameters</strong>:<!-- -->
<ul class="list-disc pl-5 my-4 leading-7">
<li class="[&amp;:not(:first-child)]:mt-2"><code>sig_ptr</code>: Pointer to the signature to verify.</li>
<li class="[&amp;:not(:first-child)]:mt-2"><code>msg_ptr</code>: Pointer to the original message.</li>
<li class="[&amp;:not(:first-child)]:mt-2"><code>msg_len</code>: The length of the message.</li>
<li class="[&amp;:not(:first-child)]:mt-2"><code>pk_ptr</code>: Pointer to the public key.</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="rationale" class="mt-12 mb-6 pt-8 text-2xl tracking-tight border-t-[1px] border-divider-light title_fb7eb">Rationale<a class="link_a7cea header-anchor link_a9ef4 inline-link_f855c" aria-hidden="true" href="#rationale">#</a></h2>
<p class="my-4 leading-7">The design of the LEA-PKMI prioritizes simplicity, security, and performance.</p>
<ul class="list-disc pl-5 my-4 leading-7">
<li class="[&amp;:not(:first-child)]:mt-2"><strong class="font-semibold">Minimalism</strong>: The interface exposes only the essential functions required for public-key cryptography. This simplifies host-side integration by providing a clear and focused set of operations.</li>
<li class="[&amp;:not(:first-child)]:mt-2"><strong class="font-semibold">Language Agnostic</strong>: By using only 32-bit integer types (<code>i32</code>), the interface remains compatible with any host language that can interact with WebAssembly, avoiding complexities of higher-level data types.</li>
<li class="[&amp;:not(:first-child)]:mt-2"><strong class="font-semibold">Explicit Memory Management</strong>: The host controls memory allocation via <code>__lea_malloc</code> and can reset the state with <code>__lea_allocator_reset</code>. This simple model avoids the need for complex memory management or garbage collection schemes across the WASM boundary.</li>
<li class="[&amp;:not(:first-child)]:mt-2"><strong class="font-semibold">Host-Provided Randomness</strong>: The module relies on the host for random data via <code>__lea_randombytes</code>. This is a critical security decision, as generating secure randomness is a responsibility best handled by the host environment, which has direct access to system-level entropy sources.</li>
</ul>
<h2 id="backwards-compatibility" class="mt-12 mb-6 pt-8 text-2xl tracking-tight border-t-[1px] border-divider-light title_fb7eb">Backwards Compatibility<a class="link_a7cea header-anchor link_a9ef4 inline-link_f855c" aria-hidden="true" href="#backwards-compatibility">#</a></h2>
<p class="my-4 leading-7">This LIP introduces a new standard and does not break any existing protocols. It is intended for new cryptographic modules developed for the LEA ecosystem. Existing modules would need to be updated to comply with this interface.</p>
<h2 id="security-considerations" class="mt-12 mb-6 pt-8 text-2xl tracking-tight border-t-[1px] border-divider-light title_fb7eb">Security Considerations<a class="link_a7cea header-anchor link_a9ef4 inline-link_f855c" aria-hidden="true" href="#security-considerations">#</a></h2>
<ul class="list-disc pl-5 my-4 leading-7">
<li class="[&amp;:not(:first-child)]:mt-2"><strong class="font-semibold">Host Responsibilities</strong>: The host environment is responsible for providing a cryptographically secure random number generator (CSPRNG) for the <code>__lea_randombytes</code> import. A weak or predictable source of randomness will compromise all cryptographic operations. The host must also handle the <code>__lea_abort</code> call by safely terminating the process to prevent further execution in a potentially corrupt state.</li>
<li class="[&amp;:not(:first-child)]:mt-2"><strong class="font-semibold">Module Responsibilities</strong>: The WASM module is a security-critical component. It must be carefully implemented and audited to ensure it is free of vulnerabilities. The module should perform all necessary input validation and operate with constant-time algorithms where appropriate to prevent side-channel attacks.</li>
<li class="[&amp;:not(:first-child)]:mt-2"><strong class="font-semibold">Interface Security</strong>: The interface itself is designed to be simple, reducing the potential for misuse. By passing data via pointers, it avoids copying large amounts of data across the WASM boundary, which can be a source of both performance issues and vulnerabilities.</li>
</ul>
<h2 id="copyright" class="mt-12 mb-6 pt-8 text-2xl tracking-tight border-t-[1px] border-divider-light title_fb7eb">Copyright<a class="link_a7cea header-anchor link_a9ef4 inline-link_f855c" aria-hidden="true" href="#copyright">#</a></h2>
<p class="my-4 leading-7">This LIP is licensed under the MIT License.</p><!--/$--></div><div class="rspress-doc-footer"><footer class="mt-8"><div class="xs:flex pb-5 px-2 justify-end items-center"></div><div class="flex flex-col"></div><div class="flex flex-col sm:flex-row sm:justify-around gap-4 pt-6"><div class="prev_c92d1 flex flex-col"><a href="/lips/LIP-0010.html" class="link_a7cea pager-link_e0d2d"><span class="desc_dcc01">Previous Page</span><span class="title_a3acb">LIP-0010: LEA Transaction Manifest (LTM)</span></a></div><div class="next_c11be flex flex-col"><a href="/lips/LIP-0012.html" class="link_a7cea pager-link_e0d2d next_ad355"><span class="desc_dcc01">Next Page</span><span class="title_a3acb">LIP-0012: LEA Keyset File Format</span></a></div></div></footer></div></div><div class="aside-container_bc5fa"><div class="flex flex-col"><div id="aside-container" class="relative text-sm font-medium"><div class="leading-7 block text-sm font-semibold pl-3">ON THIS PAGE</div><nav class="mt-1"><ul class="relative"><li><a href="#abstract" title="Abstract" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="margin-left:0;font-weight:semibold"><span class="aside-link-text block">Abstract</span></a></li><li><a href="#motivation" title="Motivation" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="margin-left:0;font-weight:semibold"><span class="aside-link-text block">Motivation</span></a></li><li><a href="#specification" title="Specification" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="margin-left:0;font-weight:semibold"><span class="aside-link-text block">Specification</span></a></li><li><a href="#1-imports" title="1. Imports" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="margin-left:12px;font-weight:semibold"><span class="aside-link-text block">1. Imports</span></a></li><li><a href="#2-exports" title="2. Exports" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="margin-left:12px;font-weight:semibold"><span class="aside-link-text block">2. Exports</span></a></li><li><a href="#21-memory" title="2.1. Memory" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="margin-left:24px;font-weight:semibold"><span class="aside-link-text block">2.1. Memory</span></a></li><li><a href="#22-allocator-functions" title="2.2. Allocator Functions" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="margin-left:24px;font-weight:semibold"><span class="aside-link-text block">2.2. Allocator Functions</span></a></li><li><a href="#23-constant-functions" title="2.3. Constant Functions" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="margin-left:24px;font-weight:semibold"><span class="aside-link-text block">2.3. Constant Functions</span></a></li><li><a href="#24-cryptographic-functions" title="2.4. Cryptographic Functions" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="margin-left:24px;font-weight:semibold"><span class="aside-link-text block">2.4. Cryptographic Functions</span></a></li><li><a href="#rationale" title="Rationale" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="margin-left:0;font-weight:semibold"><span class="aside-link-text block">Rationale</span></a></li><li><a href="#backwards-compatibility" title="Backwards Compatibility" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="margin-left:0;font-weight:semibold"><span class="aside-link-text block">Backwards Compatibility</span></a></li><li><a href="#security-considerations" title="Security Considerations" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="margin-left:0;font-weight:semibold"><span class="aside-link-text block">Security Considerations</span></a></li><li><a href="#copyright" title="Copyright" class="aside-link transition-all duration-300 hover:text-text-1 text-text-2 block" style="margin-left:0;font-weight:semibold"><span class="aside-link-text block">Copyright</span></a></li></ul></nav></div></div></div></div></div></div></section></div>
    <div id="search-container"></div>
  </body>
</html>
